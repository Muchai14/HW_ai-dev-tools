# Render manifest: declare a managed Postgres database and a Docker web service.
# The web service's `DATABASE_URL` env var is populated from the database
# connection string via `envVars.fromDatabase` so the services are explicitly linked.

databases:
  - name: coding-interview-db
    type: managed_postgresql
    plan: starter
    # databaseName will be created inside Postgres
    databaseName: coding_interview

services:
  - type: web
    name: coding-interview-app
    env: docker
    plan: starter
    dockerfilePath: ./Dockerfile
    # Use the managed DB connection string as DATABASE_URL for the web service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: coding-interview-db
          property: connectionString
    healthCheckPath: /docs

# Notes:
# - Render will provision the Postgres instance `coding-interview-db` and
#   the web service will receive a `DATABASE_URL` env var pointing to it.
# - The Dockerfile already uses the PORT env var which Render provides at runtime.
